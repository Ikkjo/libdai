\doxysection{factor.\+h}
\hypertarget{factor_8h_source}{}\label{factor_8h_source}\index{include/dai/factor.h@{include/dai/factor.h}}
\mbox{\hyperlink{factor_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{/*\ \ This\ file\ is\ part\ of\ libDAI\ -\/\ http://www.libdai.org/}}
\DoxyCodeLine{00002\ \textcolor{comment}{\ *}}
\DoxyCodeLine{00003\ \textcolor{comment}{\ *\ \ Copyright\ (c)\ 2006-\/2011,\ The\ libDAI\ authors.\ All\ rights\ reserved.}}
\DoxyCodeLine{00004\ \textcolor{comment}{\ *}}
\DoxyCodeLine{00005\ \textcolor{comment}{\ *\ \ Use\ of\ this\ source\ code\ is\ governed\ by\ a\ BSD-\/style\ license\ that\ can\ be\ found\ in\ the\ LICENSE\ file.}}
\DoxyCodeLine{00006\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00007\ }
\DoxyCodeLine{00008\ }
\DoxyCodeLine{00011\ }
\DoxyCodeLine{00012\ }
\DoxyCodeLine{00013\ \textcolor{preprocessor}{\#ifndef\ \_\_defined\_libdai\_factor\_h}}
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\#define\ \_\_defined\_libdai\_factor\_h}}
\DoxyCodeLine{00015\ }
\DoxyCodeLine{00016\ }
\DoxyCodeLine{00017\ \textcolor{preprocessor}{\#include\ <iostream>}}
\DoxyCodeLine{00018\ \textcolor{preprocessor}{\#include\ <functional>}}
\DoxyCodeLine{00019\ \textcolor{preprocessor}{\#include\ <cmath>}}
\DoxyCodeLine{00020\ \textcolor{preprocessor}{\#include\ <\mbox{\hyperlink{prob_8h}{dai/prob.h}}>}}
\DoxyCodeLine{00021\ \textcolor{preprocessor}{\#include\ <\mbox{\hyperlink{varset_8h}{dai/varset.h}}>}}
\DoxyCodeLine{00022\ \textcolor{preprocessor}{\#include\ <\mbox{\hyperlink{index_8h}{dai/index.h}}>}}
\DoxyCodeLine{00023\ \textcolor{preprocessor}{\#include\ <\mbox{\hyperlink{util_8h}{dai/util.h}}>}}
\DoxyCodeLine{00024\ }
\DoxyCodeLine{00025\ }
\DoxyCodeLine{00026\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespacedai}{dai}}\ \{}
\DoxyCodeLine{00027\ }
\DoxyCodeLine{00028\ }
\DoxyCodeLine{00030\ }
\DoxyCodeLine{00054\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{00055\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classdai_1_1TFactor}{TFactor}}\ \{}
\DoxyCodeLine{00056\ \ \ \ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00058\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdai_1_1VarSet}{VarSet}}\ \mbox{\hyperlink{classdai_1_1TFactor_ab4ba88e0b89d62aa7709852a6cafa9e6}{\_vs}};}
\DoxyCodeLine{00060\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdai_1_1TProb}{TProb<T>}}\ \mbox{\hyperlink{classdai_1_1TFactor_a34ea1a358f9248fdcd1d0b68b1313294}{\_p}};}
\DoxyCodeLine{00061\ }
\DoxyCodeLine{00062\ \ \ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00064\ }
\DoxyCodeLine{00065\ }
\DoxyCodeLine{00066\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdai_1_1TFactor_a413930641f731e37b043cfed9c85e0ce}{TFactor}}\ (\ T\ \mbox{\hyperlink{classdai_1_1TFactor_a0c074822a4ef63214ce01ed1fd7ba720}{p}}\ =\ 1\ )\ :\ \mbox{\hyperlink{classdai_1_1TFactor_ab4ba88e0b89d62aa7709852a6cafa9e6}{\_vs}}(),\ \mbox{\hyperlink{classdai_1_1TFactor_a34ea1a358f9248fdcd1d0b68b1313294}{\_p}}(1,\mbox{\hyperlink{classdai_1_1TFactor_a0c074822a4ef63214ce01ed1fd7ba720}{p}})\ \{\}}
\DoxyCodeLine{00067\ }
\DoxyCodeLine{00069\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdai_1_1TFactor_a8da41eabb003895e074d2c98a2e976a6}{TFactor}}(\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classdai_1_1Var}{Var}}\ \&\mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{v}}\ )\ :\ \mbox{\hyperlink{classdai_1_1TFactor_ab4ba88e0b89d62aa7709852a6cafa9e6}{\_vs}}(\mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{v}}),\ \mbox{\hyperlink{classdai_1_1TFactor_a34ea1a358f9248fdcd1d0b68b1313294}{\_p}}(\mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{v}}.states())\ \{\}}
\DoxyCodeLine{00070\ }
\DoxyCodeLine{00072\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdai_1_1TFactor_aa1528118bca7246714984dfe88d569d8}{TFactor}}(\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classdai_1_1VarSet}{VarSet}}\&\ \mbox{\hyperlink{classdai_1_1TFactor_a52c048326197e4d8512479b71a0c1e8f}{vars}}\ )\ :\ \mbox{\hyperlink{classdai_1_1TFactor_ab4ba88e0b89d62aa7709852a6cafa9e6}{\_vs}}(\mbox{\hyperlink{classdai_1_1TFactor_a52c048326197e4d8512479b71a0c1e8f}{vars}}),\ \mbox{\hyperlink{classdai_1_1TFactor_a34ea1a358f9248fdcd1d0b68b1313294}{\_p}}()\ \{}
\DoxyCodeLine{00073\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdai_1_1TFactor_a34ea1a358f9248fdcd1d0b68b1313294}{\_p}}\ =\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{TProb<T>}}(\ \mbox{\hyperlink{namespacedai_a8f9fdd7b607434fcda10d5be59f512d1}{BigInt\_size\_t}}(\ \mbox{\hyperlink{classdai_1_1TFactor_ab4ba88e0b89d62aa7709852a6cafa9e6}{\_vs}}.\mbox{\hyperlink{classdai_1_1VarSet_a0e247794f03ee52544e10a8b9f280c41}{nrStates}}()\ )\ );}
\DoxyCodeLine{00074\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00075\ }
\DoxyCodeLine{00077\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdai_1_1TFactor_affa1342a2ff6444cda2661c2e9829acf}{TFactor}}(\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classdai_1_1VarSet}{VarSet}}\&\ \mbox{\hyperlink{classdai_1_1TFactor_a52c048326197e4d8512479b71a0c1e8f}{vars}},\ T\ \mbox{\hyperlink{classdai_1_1TFactor_a0c074822a4ef63214ce01ed1fd7ba720}{p}}\ )\ :\ \mbox{\hyperlink{classdai_1_1TFactor_ab4ba88e0b89d62aa7709852a6cafa9e6}{\_vs}}(\mbox{\hyperlink{classdai_1_1TFactor_a52c048326197e4d8512479b71a0c1e8f}{vars}}),\ \mbox{\hyperlink{classdai_1_1TFactor_a34ea1a358f9248fdcd1d0b68b1313294}{\_p}}()\ \{}
\DoxyCodeLine{00078\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdai_1_1TFactor_a34ea1a358f9248fdcd1d0b68b1313294}{\_p}}\ =\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{TProb<T>}}(\ \mbox{\hyperlink{namespacedai_a8f9fdd7b607434fcda10d5be59f512d1}{BigInt\_size\_t}}(\ \mbox{\hyperlink{classdai_1_1TFactor_ab4ba88e0b89d62aa7709852a6cafa9e6}{\_vs}}.\mbox{\hyperlink{classdai_1_1VarSet_a0e247794f03ee52544e10a8b9f280c41}{nrStates}}()\ ),\ \mbox{\hyperlink{classdai_1_1TFactor_a0c074822a4ef63214ce01ed1fd7ba720}{p}}\ );}
\DoxyCodeLine{00079\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00080\ }
\DoxyCodeLine{00082\ }
\DoxyCodeLine{00086\ \ \ \ \ \ \ \ \ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ S>}
\DoxyCodeLine{00087\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdai_1_1TFactor_ab43e580b79ff06a7bf35b7b9faa92af6}{TFactor}}(\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classdai_1_1VarSet}{VarSet}}\&\ \mbox{\hyperlink{classdai_1_1TFactor_a52c048326197e4d8512479b71a0c1e8f}{vars}},\ \textcolor{keyword}{const}\ std::vector<S>\ \&\mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{x}}\ )\ :\ \mbox{\hyperlink{classdai_1_1TFactor_ab4ba88e0b89d62aa7709852a6cafa9e6}{\_vs}}(\mbox{\hyperlink{classdai_1_1TFactor_a52c048326197e4d8512479b71a0c1e8f}{vars}}),\ \mbox{\hyperlink{classdai_1_1TFactor_a34ea1a358f9248fdcd1d0b68b1313294}{\_p}}()\ \{}
\DoxyCodeLine{00088\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{exceptions_8h_af50adc4fad1e07093579e746302bc884}{DAI\_ASSERT}}(\ (\mbox{\hyperlink{namespacedai_acc277bd4f0edae875fca22f063a37220}{BigInt}})\mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{x}}.size()\ ==\ \mbox{\hyperlink{classdai_1_1TFactor_a52c048326197e4d8512479b71a0c1e8f}{vars}}.\mbox{\hyperlink{classdai_1_1VarSet_a0e247794f03ee52544e10a8b9f280c41}{nrStates}}()\ );}
\DoxyCodeLine{00089\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdai_1_1TFactor_a34ea1a358f9248fdcd1d0b68b1313294}{\_p}}\ =\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{TProb<T>}}(\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{x}}.begin(),\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{x}}.end(),\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{x}}.size()\ );}
\DoxyCodeLine{00090\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00091\ }
\DoxyCodeLine{00093\ }
\DoxyCodeLine{00096\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdai_1_1TFactor_a66bba72aedd5bd53390424d68bdd3b4c}{TFactor}}(\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classdai_1_1VarSet}{VarSet}}\&\ \mbox{\hyperlink{classdai_1_1TFactor_a52c048326197e4d8512479b71a0c1e8f}{vars}},\ \textcolor{keyword}{const}\ T*\ \mbox{\hyperlink{classdai_1_1TFactor_a0c074822a4ef63214ce01ed1fd7ba720}{p}}\ )\ :\ \mbox{\hyperlink{classdai_1_1TFactor_ab4ba88e0b89d62aa7709852a6cafa9e6}{\_vs}}(\mbox{\hyperlink{classdai_1_1TFactor_a52c048326197e4d8512479b71a0c1e8f}{vars}}),\ \mbox{\hyperlink{classdai_1_1TFactor_a34ea1a358f9248fdcd1d0b68b1313294}{\_p}}()\ \{}
\DoxyCodeLine{00097\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{N}}\ =\ \mbox{\hyperlink{namespacedai_a8f9fdd7b607434fcda10d5be59f512d1}{BigInt\_size\_t}}(\ \mbox{\hyperlink{classdai_1_1TFactor_ab4ba88e0b89d62aa7709852a6cafa9e6}{\_vs}}.\mbox{\hyperlink{classdai_1_1VarSet_a0e247794f03ee52544e10a8b9f280c41}{nrStates}}()\ );}
\DoxyCodeLine{00098\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdai_1_1TFactor_a34ea1a358f9248fdcd1d0b68b1313294}{\_p}}\ =\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{TProb<T>}}(\ \mbox{\hyperlink{classdai_1_1TFactor_a0c074822a4ef63214ce01ed1fd7ba720}{p}},\ \mbox{\hyperlink{classdai_1_1TFactor_a0c074822a4ef63214ce01ed1fd7ba720}{p}}\ +\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{N}},\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{N}}\ );}
\DoxyCodeLine{00099\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00100\ }
\DoxyCodeLine{00102\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdai_1_1TFactor_ac789826f975318da74da79eede4b2584}{TFactor}}(\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classdai_1_1VarSet}{VarSet}}\&\ \mbox{\hyperlink{classdai_1_1TFactor_a52c048326197e4d8512479b71a0c1e8f}{vars}},\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classdai_1_1TProb}{TProb<T>}}\ \&\mbox{\hyperlink{classdai_1_1TFactor_a0c074822a4ef63214ce01ed1fd7ba720}{p}}\ )\ :\ \mbox{\hyperlink{classdai_1_1TFactor_ab4ba88e0b89d62aa7709852a6cafa9e6}{\_vs}}(\mbox{\hyperlink{classdai_1_1TFactor_a52c048326197e4d8512479b71a0c1e8f}{vars}}),\ \mbox{\hyperlink{classdai_1_1TFactor_a34ea1a358f9248fdcd1d0b68b1313294}{\_p}}(\mbox{\hyperlink{classdai_1_1TFactor_a0c074822a4ef63214ce01ed1fd7ba720}{p}})\ \{}
\DoxyCodeLine{00103\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{exceptions_8h_af50adc4fad1e07093579e746302bc884}{DAI\_ASSERT}}(\ \mbox{\hyperlink{classdai_1_1TFactor_ab4ba88e0b89d62aa7709852a6cafa9e6}{\_vs}}.\mbox{\hyperlink{classdai_1_1VarSet_a0e247794f03ee52544e10a8b9f280c41}{nrStates}}()\ ==\ (\mbox{\hyperlink{namespacedai_acc277bd4f0edae875fca22f063a37220}{BigInt}})\mbox{\hyperlink{classdai_1_1TFactor_a34ea1a358f9248fdcd1d0b68b1313294}{\_p}}.size()\ );}
\DoxyCodeLine{00104\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00105\ }
\DoxyCodeLine{00107\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdai_1_1TFactor_a55d8a523959045be1a040f2d33436c8d}{TFactor}}(\ \textcolor{keyword}{const}\ std::vector<Var>\ \&\mbox{\hyperlink{classdai_1_1TFactor_a52c048326197e4d8512479b71a0c1e8f}{vars}},\ \textcolor{keyword}{const}\ std::vector<T>\ \&\mbox{\hyperlink{classdai_1_1TFactor_a0c074822a4ef63214ce01ed1fd7ba720}{p}}\ )\ :\ \mbox{\hyperlink{classdai_1_1TFactor_ab4ba88e0b89d62aa7709852a6cafa9e6}{\_vs}}(\mbox{\hyperlink{classdai_1_1TFactor_a52c048326197e4d8512479b71a0c1e8f}{vars}}.begin(),\ \mbox{\hyperlink{classdai_1_1TFactor_a52c048326197e4d8512479b71a0c1e8f}{vars}}.end(),\ \mbox{\hyperlink{classdai_1_1TFactor_a52c048326197e4d8512479b71a0c1e8f}{vars}}.size()),\ \mbox{\hyperlink{classdai_1_1TFactor_a34ea1a358f9248fdcd1d0b68b1313294}{\_p}}(\mbox{\hyperlink{classdai_1_1TFactor_a0c074822a4ef63214ce01ed1fd7ba720}{p}}.size())\ \{}
\DoxyCodeLine{00108\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacedai_acc277bd4f0edae875fca22f063a37220}{BigInt}}\ \mbox{\hyperlink{classdai_1_1TFactor_a9358f7015c13296208f7a883adc7892d}{nrStates}}\ =\ 1;}
\DoxyCodeLine{00109\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\ \textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classdai_1_1TFactor_a52c048326197e4d8512479b71a0c1e8f}{vars}}.\mbox{\hyperlink{classdai_1_1SmallSet_a898d22e10b6870ddc4be574cd583ce26}{size}}();\ i++\ )}
\DoxyCodeLine{00110\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdai_1_1TFactor_a9358f7015c13296208f7a883adc7892d}{nrStates}}\ *=\ \mbox{\hyperlink{classdai_1_1TFactor_a52c048326197e4d8512479b71a0c1e8f}{vars}}[i].states();}
\DoxyCodeLine{00111\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{exceptions_8h_af50adc4fad1e07093579e746302bc884}{DAI\_ASSERT}}(\ \mbox{\hyperlink{classdai_1_1TFactor_a9358f7015c13296208f7a883adc7892d}{nrStates}}\ ==\ \mbox{\hyperlink{classdai_1_1TFactor_a0c074822a4ef63214ce01ed1fd7ba720}{p}}.size()\ );}
\DoxyCodeLine{00112\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdai_1_1Permute}{Permute}}\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{permindex}}(\mbox{\hyperlink{classdai_1_1TFactor_a52c048326197e4d8512479b71a0c1e8f}{vars}});}
\DoxyCodeLine{00113\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{li}}\ =\ 0;\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{li}}\ <\ \mbox{\hyperlink{classdai_1_1TFactor_a0c074822a4ef63214ce01ed1fd7ba720}{p}}.size();\ ++\mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{li}}\ )}
\DoxyCodeLine{00114\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdai_1_1TFactor_a34ea1a358f9248fdcd1d0b68b1313294}{\_p}}.set(\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{permindex}}.convertLinearIndex(\mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{li}}),\ \mbox{\hyperlink{classdai_1_1TFactor_a0c074822a4ef63214ce01ed1fd7ba720}{p}}[\mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{li}}]\ );}
\DoxyCodeLine{00115\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00117\ }
\DoxyCodeLine{00119\ }
\DoxyCodeLine{00120\ }
\DoxyCodeLine{00121\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classdai_1_1TFactor_a52963ca6221af355da0eb0c742d6a113}{set}}(\ \textcolor{keywordtype}{size\_t}\ i,\ T\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{val}}\ )\ \{\ \mbox{\hyperlink{classdai_1_1TFactor_a34ea1a358f9248fdcd1d0b68b1313294}{\_p}}.set(\ i,\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{val}}\ );\ \}}
\DoxyCodeLine{00122\ }
\DoxyCodeLine{00124\ \ \ \ \ \ \ \ \ T\ \mbox{\hyperlink{classdai_1_1TFactor_a71bb1a09500d51ad217a7aceb32bdfc5}{get}}(\ \textcolor{keywordtype}{size\_t}\ i\ )\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classdai_1_1TFactor_a34ea1a358f9248fdcd1d0b68b1313294}{\_p}}[i];\ \}}
\DoxyCodeLine{00126\ }
\DoxyCodeLine{00128\ }
\DoxyCodeLine{00129\ }
\DoxyCodeLine{00130\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classdai_1_1TProb}{TProb<T>}}\&\ \mbox{\hyperlink{classdai_1_1TFactor_a0c074822a4ef63214ce01ed1fd7ba720}{p}}()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classdai_1_1TFactor_a34ea1a358f9248fdcd1d0b68b1313294}{\_p}};\ \}}
\DoxyCodeLine{00131\ }
\DoxyCodeLine{00133\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdai_1_1TProb}{TProb<T>}}\&\ \mbox{\hyperlink{classdai_1_1TFactor_a265bd98cbf0a564f330a166c9d6d9af7}{p}}()\ \{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classdai_1_1TFactor_a34ea1a358f9248fdcd1d0b68b1313294}{\_p}};\ \}}
\DoxyCodeLine{00134\ }
\DoxyCodeLine{00136\ \ \ \ \ \ \ \ \ T\ \mbox{\hyperlink{classdai_1_1TFactor_a7f0cff4729027a0f56a7d6b653fa5798}{operator[]\ }}(\textcolor{keywordtype}{size\_t}\ i)\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classdai_1_1TFactor_a34ea1a358f9248fdcd1d0b68b1313294}{\_p}}[i];\ \}}
\DoxyCodeLine{00137\ }
\DoxyCodeLine{00139\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classdai_1_1VarSet}{VarSet}}\&\ \mbox{\hyperlink{classdai_1_1TFactor_a52c048326197e4d8512479b71a0c1e8f}{vars}}()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classdai_1_1TFactor_ab4ba88e0b89d62aa7709852a6cafa9e6}{\_vs}};\ \}}
\DoxyCodeLine{00140\ }
\DoxyCodeLine{00142\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdai_1_1VarSet}{VarSet}}\&\ \mbox{\hyperlink{classdai_1_1TFactor_aa291d6ff450b10496fff5448066e4263}{vars}}()\ \{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classdai_1_1TFactor_ab4ba88e0b89d62aa7709852a6cafa9e6}{\_vs}};\ \}}
\DoxyCodeLine{00143\ }
\DoxyCodeLine{00145\ }
\DoxyCodeLine{00147\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classdai_1_1TFactor_a9358f7015c13296208f7a883adc7892d}{nrStates}}()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classdai_1_1TFactor_a34ea1a358f9248fdcd1d0b68b1313294}{\_p}}.size();\ \}}
\DoxyCodeLine{00148\ }
\DoxyCodeLine{00150\ \ \ \ \ \ \ \ \ T\ \mbox{\hyperlink{classdai_1_1TFactor_ad0fc0175f7d0e20138f5a4cc8f204c70}{entropy}}()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classdai_1_1TFactor_a34ea1a358f9248fdcd1d0b68b1313294}{\_p}}.entropy();\ \}}
\DoxyCodeLine{00151\ }
\DoxyCodeLine{00153\ \ \ \ \ \ \ \ \ T\ \mbox{\hyperlink{classdai_1_1TFactor_a78985a1f176725b797f48902f159d3b2}{max}}()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classdai_1_1TFactor_a34ea1a358f9248fdcd1d0b68b1313294}{\_p}}.max();\ \}}
\DoxyCodeLine{00154\ }
\DoxyCodeLine{00156\ \ \ \ \ \ \ \ \ T\ \mbox{\hyperlink{classdai_1_1TFactor_a9b24c32c1f43a236cbe5eb0cbfa38478}{min}}()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classdai_1_1TFactor_a34ea1a358f9248fdcd1d0b68b1313294}{\_p}}.min();\ \}}
\DoxyCodeLine{00157\ }
\DoxyCodeLine{00159\ \ \ \ \ \ \ \ \ T\ \mbox{\hyperlink{classdai_1_1TFactor_a10793dce8ae57ac2dfc181c8bebf1b58}{sum}}()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classdai_1_1TFactor_a34ea1a358f9248fdcd1d0b68b1313294}{\_p}}.sum();\ \}}
\DoxyCodeLine{00160\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00162\ \ \ \ \ \ \ \ \ T\ \mbox{\hyperlink{classdai_1_1TFactor_aa42f6ff31b67d6b1713af806a8ce5996}{sumAbs}}()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classdai_1_1TFactor_a34ea1a358f9248fdcd1d0b68b1313294}{\_p}}.sumAbs();\ \}}
\DoxyCodeLine{00163\ }
\DoxyCodeLine{00165\ \ \ \ \ \ \ \ \ T\ \mbox{\hyperlink{classdai_1_1TFactor_aca4d4113fcf1fac1a1e13ad15d9fe1c6}{maxAbs}}()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classdai_1_1TFactor_a34ea1a358f9248fdcd1d0b68b1313294}{\_p}}.maxAbs();\ \}}
\DoxyCodeLine{00166\ }
\DoxyCodeLine{00168\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classdai_1_1TFactor_a0da53d477738c80bc917d9a2f2e7c0b0}{hasNaNs}}()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classdai_1_1TFactor_a34ea1a358f9248fdcd1d0b68b1313294}{\_p}}.hasNaNs();\ \}}
\DoxyCodeLine{00169\ }
\DoxyCodeLine{00171\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classdai_1_1TFactor_a5c373c81a3bb7f9c788ac940469f439d}{hasNegatives}}()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classdai_1_1TFactor_a34ea1a358f9248fdcd1d0b68b1313294}{\_p}}.hasNegatives();\ \}}
\DoxyCodeLine{00172\ }
\DoxyCodeLine{00174\ \ \ \ \ \ \ \ \ T\ \mbox{\hyperlink{classdai_1_1TFactor_a79c10008a081bf56e79fab4fb9d564f7}{strength}}(\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classdai_1_1Var}{Var}}\ \&i,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classdai_1_1Var}{Var}}\ \&\mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{j}}\ )\ \textcolor{keyword}{const};}
\DoxyCodeLine{00175\ }
\DoxyCodeLine{00177\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classdai_1_1TFactor_a5f754f064a9b943768f7c8ed53149653}{operator==}}(\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classdai_1_1TFactor}{TFactor<T>}}\&\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{y}}\ )\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00178\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ (\mbox{\hyperlink{classdai_1_1TFactor_ab4ba88e0b89d62aa7709852a6cafa9e6}{\_vs}}\ ==\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{y}}.\_vs)\ \&\&\ (\mbox{\hyperlink{classdai_1_1TFactor_a34ea1a358f9248fdcd1d0b68b1313294}{\_p}}\ ==\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{y}}.\_p);}
\DoxyCodeLine{00179\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00180\ }
\DoxyCodeLine{00182\ \ \ \ \ \ \ \ \ std::string\ \mbox{\hyperlink{classdai_1_1TFactor_a9c3a68a0123fd90886b6cb9c85adc8c6}{toString}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00183\ \ \ \ \ \ \ \ \ \ \ \ \ std::stringstream\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{ss}};}
\DoxyCodeLine{00184\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{ss}}\ <<\ *\textcolor{keyword}{this};}
\DoxyCodeLine{00185\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{ss}}.str();}
\DoxyCodeLine{00186\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00188\ }
\DoxyCodeLine{00190\ }
\DoxyCodeLine{00191\ }
\DoxyCodeLine{00192\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdai_1_1TFactor}{TFactor<T>}}\ \mbox{\hyperlink{classdai_1_1TFactor_a6b4720129a8e9a762b1fa34e5e863b46}{operator-\/\ }}()\textcolor{keyword}{\ const\ }\{\ }
\DoxyCodeLine{00193\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Note:\ the\ alternative\ (shorter)\ way\ of\ implementing\ this,}}
\DoxyCodeLine{00194\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ \ \ return\ TFactor<T>(\ \_vs,\ \_p.abs()\ );}}
\DoxyCodeLine{00195\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ is\ slower\ because\ it\ invokes\ the\ copy\ constructor\ of\ TProb<T>}}
\DoxyCodeLine{00196\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdai_1_1TFactor}{TFactor<T>}}\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{x}};}
\DoxyCodeLine{00197\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{x}}.\mbox{\hyperlink{classdai_1_1TFactor_ab4ba88e0b89d62aa7709852a6cafa9e6}{\_vs}}\ =\ \mbox{\hyperlink{classdai_1_1TFactor_ab4ba88e0b89d62aa7709852a6cafa9e6}{\_vs}};}
\DoxyCodeLine{00198\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{x}}.\_p\ =\ -\/\mbox{\hyperlink{classdai_1_1TFactor_a34ea1a358f9248fdcd1d0b68b1313294}{\_p}};}
\DoxyCodeLine{00199\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{x}};}
\DoxyCodeLine{00200\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00201\ }
\DoxyCodeLine{00203\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdai_1_1TFactor}{TFactor<T>}}\ \mbox{\hyperlink{classdai_1_1TFactor_a47363c4f80a69794940089fa0d4b9000}{abs}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00204\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdai_1_1TFactor}{TFactor<T>}}\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{x}};}
\DoxyCodeLine{00205\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{x}}.\mbox{\hyperlink{classdai_1_1TFactor_ab4ba88e0b89d62aa7709852a6cafa9e6}{\_vs}}\ =\ \mbox{\hyperlink{classdai_1_1TFactor_ab4ba88e0b89d62aa7709852a6cafa9e6}{\_vs}};}
\DoxyCodeLine{00206\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{x}}.\_p\ =\ \mbox{\hyperlink{classdai_1_1TFactor_a34ea1a358f9248fdcd1d0b68b1313294}{\_p}}.abs();}
\DoxyCodeLine{00207\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{x}};}
\DoxyCodeLine{00208\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00209\ }
\DoxyCodeLine{00211\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdai_1_1TFactor}{TFactor<T>}}\ \mbox{\hyperlink{classdai_1_1TFactor_a0a7856a82580aaf64c1e4a873b9a2299}{exp}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00212\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdai_1_1TFactor}{TFactor<T>}}\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{x}};}
\DoxyCodeLine{00213\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{x}}.\mbox{\hyperlink{classdai_1_1TFactor_ab4ba88e0b89d62aa7709852a6cafa9e6}{\_vs}}\ =\ \mbox{\hyperlink{classdai_1_1TFactor_ab4ba88e0b89d62aa7709852a6cafa9e6}{\_vs}};}
\DoxyCodeLine{00214\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{x}}.\_p\ =\ \mbox{\hyperlink{classdai_1_1TFactor_a34ea1a358f9248fdcd1d0b68b1313294}{\_p}}.exp();}
\DoxyCodeLine{00215\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{x}};}
\DoxyCodeLine{00216\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00217\ }
\DoxyCodeLine{00219\ }
\DoxyCodeLine{00221\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdai_1_1TFactor}{TFactor<T>}}\ \mbox{\hyperlink{classdai_1_1TFactor_aa9316aae8c2244a58257f682193fcec2}{log}}(\textcolor{keywordtype}{bool}\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{zero}}=\textcolor{keyword}{false})\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00222\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdai_1_1TFactor}{TFactor<T>}}\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{x}};}
\DoxyCodeLine{00223\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{x}}.\mbox{\hyperlink{classdai_1_1TFactor_ab4ba88e0b89d62aa7709852a6cafa9e6}{\_vs}}\ =\ \mbox{\hyperlink{classdai_1_1TFactor_ab4ba88e0b89d62aa7709852a6cafa9e6}{\_vs}};}
\DoxyCodeLine{00224\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{x}}.\_p\ =\ \mbox{\hyperlink{classdai_1_1TFactor_a34ea1a358f9248fdcd1d0b68b1313294}{\_p}}.log(\mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{zero}});}
\DoxyCodeLine{00225\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{x}};}
\DoxyCodeLine{00226\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00227\ }
\DoxyCodeLine{00229\ }
\DoxyCodeLine{00231\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdai_1_1TFactor}{TFactor<T>}}\ \mbox{\hyperlink{classdai_1_1TFactor_a191fc92b91b5001c93604d4863dcd5c0}{inverse}}(\textcolor{keywordtype}{bool}\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{zero}}=\textcolor{keyword}{true})\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00232\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdai_1_1TFactor}{TFactor<T>}}\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{x}};}
\DoxyCodeLine{00233\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{x}}.\mbox{\hyperlink{classdai_1_1TFactor_ab4ba88e0b89d62aa7709852a6cafa9e6}{\_vs}}\ =\ \mbox{\hyperlink{classdai_1_1TFactor_ab4ba88e0b89d62aa7709852a6cafa9e6}{\_vs}};}
\DoxyCodeLine{00234\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{x}}.\_p\ =\ \mbox{\hyperlink{classdai_1_1TFactor_a34ea1a358f9248fdcd1d0b68b1313294}{\_p}}.inverse(\mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{zero}});}
\DoxyCodeLine{00235\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{x}};}
\DoxyCodeLine{00236\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00237\ }
\DoxyCodeLine{00239\ }
\DoxyCodeLine{00241\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdai_1_1TFactor}{TFactor<T>}}\ \mbox{\hyperlink{classdai_1_1TFactor_a69c79a8ead315cac1010276fc6b6cb5d}{normalized}}(\ \mbox{\hyperlink{namespacedai_ae0d0ef753bd0ba57586e556ab6312677}{ProbNormType}}\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{norm}}=NORMPROB\ )\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00242\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdai_1_1TFactor}{TFactor<T>}}\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{x}};}
\DoxyCodeLine{00243\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{x}}.\mbox{\hyperlink{classdai_1_1TFactor_ab4ba88e0b89d62aa7709852a6cafa9e6}{\_vs}}\ =\ \mbox{\hyperlink{classdai_1_1TFactor_ab4ba88e0b89d62aa7709852a6cafa9e6}{\_vs}};}
\DoxyCodeLine{00244\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{x}}.\_p\ =\ \mbox{\hyperlink{classdai_1_1TFactor_a34ea1a358f9248fdcd1d0b68b1313294}{\_p}}.normalized(\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{norm}}\ );}
\DoxyCodeLine{00245\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{x}};}
\DoxyCodeLine{00246\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00248\ }
\DoxyCodeLine{00250\ }
\DoxyCodeLine{00251\ }
\DoxyCodeLine{00252\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdai_1_1TFactor}{TFactor<T>}}\&\ \mbox{\hyperlink{classdai_1_1TFactor_a2b5a63dce4d8fc20086c229088e2de52}{randomize}}()\ \{\ \mbox{\hyperlink{classdai_1_1TFactor_a34ea1a358f9248fdcd1d0b68b1313294}{\_p}}.randomize();\ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{this};\ \}}
\DoxyCodeLine{00253\ }
\DoxyCodeLine{00255\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdai_1_1TFactor}{TFactor<T>}}\&\ \mbox{\hyperlink{classdai_1_1TFactor_ab4541c02c0e22d0dab12d29aa165b256}{setUniform}}()\ \{\ \mbox{\hyperlink{classdai_1_1TFactor_a34ea1a358f9248fdcd1d0b68b1313294}{\_p}}.setUniform();\ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{this};\ \}}
\DoxyCodeLine{00256\ }
\DoxyCodeLine{00258\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdai_1_1TFactor}{TFactor<T>}}\&\ \mbox{\hyperlink{classdai_1_1TFactor_ac64cb602bb444e7eb4b1e0173e3019cb}{takeAbs}}()\ \{\ \mbox{\hyperlink{classdai_1_1TFactor_a34ea1a358f9248fdcd1d0b68b1313294}{\_p}}.takeAbs();\ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{this};\ \}}
\DoxyCodeLine{00259\ }
\DoxyCodeLine{00261\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdai_1_1TFactor}{TFactor<T>}}\&\ \mbox{\hyperlink{classdai_1_1TFactor_aca0a3f622efa8714d443dcfac00675e9}{takeExp}}()\ \{\ \mbox{\hyperlink{classdai_1_1TFactor_a34ea1a358f9248fdcd1d0b68b1313294}{\_p}}.takeExp();\ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{this};\ \}}
\DoxyCodeLine{00262\ }
\DoxyCodeLine{00264\ }
\DoxyCodeLine{00266\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdai_1_1TFactor}{TFactor<T>}}\&\ \mbox{\hyperlink{classdai_1_1TFactor_a4e6dce445d9021938d1ce65c1472baaf}{takeLog}}(\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{zero}}\ =\ \textcolor{keyword}{false}\ )\ \{\ \mbox{\hyperlink{classdai_1_1TFactor_a34ea1a358f9248fdcd1d0b68b1313294}{\_p}}.takeLog(\mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{zero}});\ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{this};\ \}}
\DoxyCodeLine{00267\ }
\DoxyCodeLine{00269\ }
\DoxyCodeLine{00271\ \ \ \ \ \ \ \ \ T\ \mbox{\hyperlink{classdai_1_1TFactor_a2395b393cfa1b05ed5eb8984bb06de0f}{normalize}}(\ \mbox{\hyperlink{namespacedai_ae0d0ef753bd0ba57586e556ab6312677}{ProbNormType}}\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{norm}}=NORMPROB\ )\ \{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classdai_1_1TFactor_a34ea1a358f9248fdcd1d0b68b1313294}{\_p}}.normalize(\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{norm}}\ );\ \}}
\DoxyCodeLine{00273\ }
\DoxyCodeLine{00275\ }
\DoxyCodeLine{00276\ }
\DoxyCodeLine{00277\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdai_1_1TFactor}{TFactor<T>}}\&\ \mbox{\hyperlink{classdai_1_1TFactor_a27fde4dee0eaf7759251c6a1bda55ad0}{fill}}\ (T\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{x}})\ \{\ \mbox{\hyperlink{classdai_1_1TFactor_a34ea1a358f9248fdcd1d0b68b1313294}{\_p}}.fill(\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{x}}\ );\ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{this};\ \}}
\DoxyCodeLine{00278\ }
\DoxyCodeLine{00280\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdai_1_1TFactor}{TFactor<T>}}\&\ \mbox{\hyperlink{classdai_1_1TFactor_aaa04d4b26d17d6733ff5353b818e6274}{operator+=\ }}(T\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{x}})\ \{\ \mbox{\hyperlink{classdai_1_1TFactor_a34ea1a358f9248fdcd1d0b68b1313294}{\_p}}\ +=\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{x}};\ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{this};\ \}}
\DoxyCodeLine{00281\ }
\DoxyCodeLine{00283\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdai_1_1TFactor}{TFactor<T>}}\&\ \mbox{\hyperlink{classdai_1_1TFactor_a7527edbb4055ade137cac93bf4bd8186}{operator-\/=\ }}(T\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{x}})\ \{\ \mbox{\hyperlink{classdai_1_1TFactor_a34ea1a358f9248fdcd1d0b68b1313294}{\_p}}\ -\/=\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{x}};\ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{this};\ \}}
\DoxyCodeLine{00284\ }
\DoxyCodeLine{00286\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdai_1_1TFactor}{TFactor<T>}}\&\ \mbox{\hyperlink{classdai_1_1TFactor_a5d15b44aeba7dc76ce4b5eb3188d98b0}{operator*=\ }}(T\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{x}})\ \{\ \mbox{\hyperlink{classdai_1_1TFactor_a34ea1a358f9248fdcd1d0b68b1313294}{\_p}}\ *=\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{x}};\ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{this};\ \}}
\DoxyCodeLine{00287\ }
\DoxyCodeLine{00289\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdai_1_1TFactor}{TFactor<T>}}\&\ \mbox{\hyperlink{classdai_1_1TFactor_afc16192cc27715116b5f91ffc803db0f}{operator/=\ }}(T\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{x}})\ \{\ \mbox{\hyperlink{classdai_1_1TFactor_a34ea1a358f9248fdcd1d0b68b1313294}{\_p}}\ /=\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{x}};\ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{this};\ \}}
\DoxyCodeLine{00290\ }
\DoxyCodeLine{00292\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdai_1_1TFactor}{TFactor<T>}}\&\ \mbox{\hyperlink{classdai_1_1TFactor_ab74d5199dada7821520f4b3c1330ddc5}{operator\string^=\ }}(T\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{x}})\ \{\ \mbox{\hyperlink{classdai_1_1TFactor_a34ea1a358f9248fdcd1d0b68b1313294}{\_p}}\ \string^=\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{x}};\ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{this};\ \}}
\DoxyCodeLine{00294\ }
\DoxyCodeLine{00296\ }
\DoxyCodeLine{00297\ }
\DoxyCodeLine{00298\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdai_1_1TFactor}{TFactor<T>}}\ \mbox{\hyperlink{classdai_1_1TFactor_ae6c4b5f251d7e966f3a4d46ec665a0fd}{operator+\ }}(T\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{x}})\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00299\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Note:\ the\ alternative\ (shorter)\ way\ of\ implementing\ this,}}
\DoxyCodeLine{00300\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ \ \ TFactor<T>\ result(*this);}}
\DoxyCodeLine{00301\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ \ \ result.\_p\ +=\ x;}}
\DoxyCodeLine{00302\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ is\ slower\ because\ it\ invokes\ the\ copy\ constructor\ of\ TFactor<T>}}
\DoxyCodeLine{00303\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdai_1_1TFactor}{TFactor<T>}}\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{result}};}
\DoxyCodeLine{00304\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{result}}.\mbox{\hyperlink{classdai_1_1TFactor_ab4ba88e0b89d62aa7709852a6cafa9e6}{\_vs}}\ =\ \mbox{\hyperlink{classdai_1_1TFactor_ab4ba88e0b89d62aa7709852a6cafa9e6}{\_vs}};}
\DoxyCodeLine{00305\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{result}}.\_p\ =\ \mbox{\hyperlink{classdai_1_1TFactor_a0c074822a4ef63214ce01ed1fd7ba720}{p}}()\ +\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{x}};}
\DoxyCodeLine{00306\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{result}};}
\DoxyCodeLine{00307\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00308\ }
\DoxyCodeLine{00310\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdai_1_1TFactor}{TFactor<T>}}\ \mbox{\hyperlink{classdai_1_1TFactor_a6b4720129a8e9a762b1fa34e5e863b46}{operator-\/\ }}(T\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{x}})\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00311\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdai_1_1TFactor}{TFactor<T>}}\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{result}};}
\DoxyCodeLine{00312\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{result}}.\mbox{\hyperlink{classdai_1_1TFactor_ab4ba88e0b89d62aa7709852a6cafa9e6}{\_vs}}\ =\ \mbox{\hyperlink{classdai_1_1TFactor_ab4ba88e0b89d62aa7709852a6cafa9e6}{\_vs}};}
\DoxyCodeLine{00313\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{result}}.\_p\ =\ \mbox{\hyperlink{classdai_1_1TFactor_a0c074822a4ef63214ce01ed1fd7ba720}{p}}()\ -\/\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{x}};}
\DoxyCodeLine{00314\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{result}};}
\DoxyCodeLine{00315\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00316\ }
\DoxyCodeLine{00318\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdai_1_1TFactor}{TFactor<T>}}\ \mbox{\hyperlink{classdai_1_1TFactor_afa9e4dd05b4f94531fbbf3719c97f848}{operator*\ }}(T\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{x}})\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00319\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdai_1_1TFactor}{TFactor<T>}}\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{result}};}
\DoxyCodeLine{00320\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{result}}.\mbox{\hyperlink{classdai_1_1TFactor_ab4ba88e0b89d62aa7709852a6cafa9e6}{\_vs}}\ =\ \mbox{\hyperlink{classdai_1_1TFactor_ab4ba88e0b89d62aa7709852a6cafa9e6}{\_vs}};}
\DoxyCodeLine{00321\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{result}}.\_p\ =\ \mbox{\hyperlink{classdai_1_1TFactor_a0c074822a4ef63214ce01ed1fd7ba720}{p}}()\ *\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{x}};}
\DoxyCodeLine{00322\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{result}};}
\DoxyCodeLine{00323\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00324\ }
\DoxyCodeLine{00326\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdai_1_1TFactor}{TFactor<T>}}\ \mbox{\hyperlink{classdai_1_1TFactor_ad49392c3b36d00b55cf6ffb143bb4f71}{operator/\ }}(T\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{x}})\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00327\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdai_1_1TFactor}{TFactor<T>}}\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{result}};}
\DoxyCodeLine{00328\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{result}}.\mbox{\hyperlink{classdai_1_1TFactor_ab4ba88e0b89d62aa7709852a6cafa9e6}{\_vs}}\ =\ \mbox{\hyperlink{classdai_1_1TFactor_ab4ba88e0b89d62aa7709852a6cafa9e6}{\_vs}};}
\DoxyCodeLine{00329\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{result}}.\_p\ =\ \mbox{\hyperlink{classdai_1_1TFactor_a0c074822a4ef63214ce01ed1fd7ba720}{p}}()\ /\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{x}};}
\DoxyCodeLine{00330\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{result}};}
\DoxyCodeLine{00331\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00332\ }
\DoxyCodeLine{00334\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdai_1_1TFactor}{TFactor<T>}}\ \mbox{\hyperlink{classdai_1_1TFactor_a1e062980919c16267a872ccaac60c3ed}{operator\string^\ }}(T\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{x}})\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00335\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdai_1_1TFactor}{TFactor<T>}}\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{result}};}
\DoxyCodeLine{00336\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{result}}.\mbox{\hyperlink{classdai_1_1TFactor_ab4ba88e0b89d62aa7709852a6cafa9e6}{\_vs}}\ =\ \mbox{\hyperlink{classdai_1_1TFactor_ab4ba88e0b89d62aa7709852a6cafa9e6}{\_vs}};}
\DoxyCodeLine{00337\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{result}}.\_p\ =\ \mbox{\hyperlink{classdai_1_1TFactor_a0c074822a4ef63214ce01ed1fd7ba720}{p}}()\ \string^\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{x}};}
\DoxyCodeLine{00338\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{result}};}
\DoxyCodeLine{00339\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00341\ }
\DoxyCodeLine{00343\ }
\DoxyCodeLine{00344\ }
\DoxyCodeLine{00349\ \ \ \ \ \ \ \ \ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ binOp>\ \mbox{\hyperlink{classdai_1_1TFactor}{TFactor<T>}}\&\ \mbox{\hyperlink{classdai_1_1TFactor_abd8b834e32345eb550a07d0608214fad}{binaryOp}}(\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classdai_1_1TFactor}{TFactor<T>}}\ \&\mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{g}},\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{binOp}}\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{op}}\ )\ \{}
\DoxyCodeLine{00350\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\ \mbox{\hyperlink{classdai_1_1TFactor_ab4ba88e0b89d62aa7709852a6cafa9e6}{\_vs}}\ ==\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{g}}.\_vs\ )\ \textcolor{comment}{//\ optimize\ special\ case}}
\DoxyCodeLine{00351\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdai_1_1TFactor_a34ea1a358f9248fdcd1d0b68b1313294}{\_p}}.pwBinaryOp(\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{g}}.\_p,\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{op}}\ );}
\DoxyCodeLine{00352\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00353\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdai_1_1TFactor}{TFactor<T>}}\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{f}}(*\textcolor{keyword}{this});\ \textcolor{comment}{//\ make\ a\ copy}}
\DoxyCodeLine{00354\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdai_1_1TFactor_ab4ba88e0b89d62aa7709852a6cafa9e6}{\_vs}}\ |=\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{g}}.\_vs;}
\DoxyCodeLine{00355\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{N}}\ =\ \mbox{\hyperlink{namespacedai_a8f9fdd7b607434fcda10d5be59f512d1}{BigInt\_size\_t}}(\ \mbox{\hyperlink{classdai_1_1TFactor_ab4ba88e0b89d62aa7709852a6cafa9e6}{\_vs}}.\mbox{\hyperlink{classdai_1_1VarSet_a0e247794f03ee52544e10a8b9f280c41}{nrStates}}()\ );}
\DoxyCodeLine{00356\ }
\DoxyCodeLine{00357\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdai_1_1IndexFor}{IndexFor}}\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{i\_f}}(\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{f}}.\_vs,\ \mbox{\hyperlink{classdai_1_1TFactor_ab4ba88e0b89d62aa7709852a6cafa9e6}{\_vs}}\ );}
\DoxyCodeLine{00358\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdai_1_1IndexFor}{IndexFor}}\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{i\_g}}(\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{g}}.\_vs,\ \mbox{\hyperlink{classdai_1_1TFactor_ab4ba88e0b89d62aa7709852a6cafa9e6}{\_vs}}\ );}
\DoxyCodeLine{00359\ }
\DoxyCodeLine{00360\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdai_1_1TFactor_a34ea1a358f9248fdcd1d0b68b1313294}{\_p}}.p().clear();}
\DoxyCodeLine{00361\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdai_1_1TFactor_a34ea1a358f9248fdcd1d0b68b1313294}{\_p}}.p().reserve(\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{N}}\ );}
\DoxyCodeLine{00362\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\ \textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{N}};\ i++,\ ++\mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{i\_f}},\ ++\mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{i\_g}}\ )}
\DoxyCodeLine{00363\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdai_1_1TFactor_a34ea1a358f9248fdcd1d0b68b1313294}{\_p}}.p().push\_back(\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{op}}(\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{f}}.\_p[\mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{i\_f}}],\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{g}}.\_p[\mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{i\_g}}]\ )\ );}
\DoxyCodeLine{00364\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00365\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{this};}
\DoxyCodeLine{00366\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00367\ }
\DoxyCodeLine{00369\ }
\DoxyCodeLine{00373\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdai_1_1TFactor}{TFactor<T>}}\&\ \mbox{\hyperlink{classdai_1_1TFactor_aaa04d4b26d17d6733ff5353b818e6274}{operator+=\ }}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classdai_1_1TFactor}{TFactor<T>}}\&\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{g}})\ \{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classdai_1_1TFactor_abd8b834e32345eb550a07d0608214fad}{binaryOp}}(\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{g}},\ std::plus<T>()\ );\ \}}
\DoxyCodeLine{00374\ }
\DoxyCodeLine{00376\ }
\DoxyCodeLine{00380\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdai_1_1TFactor}{TFactor<T>}}\&\ \mbox{\hyperlink{classdai_1_1TFactor_a7527edbb4055ade137cac93bf4bd8186}{operator-\/=\ }}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classdai_1_1TFactor}{TFactor<T>}}\&\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{g}})\ \{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classdai_1_1TFactor_abd8b834e32345eb550a07d0608214fad}{binaryOp}}(\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{g}},\ std::minus<T>()\ );\ \}}
\DoxyCodeLine{00381\ }
\DoxyCodeLine{00383\ }
\DoxyCodeLine{00387\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdai_1_1TFactor}{TFactor<T>}}\&\ \mbox{\hyperlink{classdai_1_1TFactor_a5d15b44aeba7dc76ce4b5eb3188d98b0}{operator*=\ }}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classdai_1_1TFactor}{TFactor<T>}}\&\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{g}})\ \{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classdai_1_1TFactor_abd8b834e32345eb550a07d0608214fad}{binaryOp}}(\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{g}},\ std::multiplies<T>()\ );\ \}}
\DoxyCodeLine{00388\ }
\DoxyCodeLine{00390\ }
\DoxyCodeLine{00394\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdai_1_1TFactor}{TFactor<T>}}\&\ \mbox{\hyperlink{classdai_1_1TFactor_afc16192cc27715116b5f91ffc803db0f}{operator/=\ }}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classdai_1_1TFactor}{TFactor<T>}}\&\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{g}})\ \{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classdai_1_1TFactor_abd8b834e32345eb550a07d0608214fad}{binaryOp}}(\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{g}},\ \mbox{\hyperlink{structdai_1_1fo__divides0}{fo\_divides0<T>}}()\ );\ \}}
\DoxyCodeLine{00396\ }
\DoxyCodeLine{00398\ }
\DoxyCodeLine{00399\ }
\DoxyCodeLine{00404\ \ \ \ \ \ \ \ \ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ binOp>\ \mbox{\hyperlink{classdai_1_1TFactor}{TFactor<T>}}\ \mbox{\hyperlink{classdai_1_1TFactor_a40421e4ca261192d8f71c2db6e9da6c1}{binaryTr}}(\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classdai_1_1TFactor}{TFactor<T>}}\ \&\mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{g}},\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{binOp}}\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{op}}\ )\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00405\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Note\ that\ to\ prevent\ a\ copy\ to\ be\ made,\ it\ is\ crucial\ }}
\DoxyCodeLine{00406\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ that\ the\ result\ is\ declared\ outside\ the\ if-\/else\ construct.}}
\DoxyCodeLine{00407\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdai_1_1TFactor}{TFactor<T>}}\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{result}};}
\DoxyCodeLine{00408\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\ \mbox{\hyperlink{classdai_1_1TFactor_ab4ba88e0b89d62aa7709852a6cafa9e6}{\_vs}}\ ==\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{g}}.\_vs\ )\ \{\ \textcolor{comment}{//\ optimize\ special\ case}}
\DoxyCodeLine{00409\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{result}}.\mbox{\hyperlink{classdai_1_1TFactor_ab4ba88e0b89d62aa7709852a6cafa9e6}{\_vs}}\ =\ \mbox{\hyperlink{classdai_1_1TFactor_ab4ba88e0b89d62aa7709852a6cafa9e6}{\_vs}};}
\DoxyCodeLine{00410\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{result}}.\_p\ =\ \mbox{\hyperlink{classdai_1_1TFactor_a34ea1a358f9248fdcd1d0b68b1313294}{\_p}}.pwBinaryTr(\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{g}}.\_p,\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{op}}\ );}
\DoxyCodeLine{00411\ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00412\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{result}}.\_vs\ =\ \mbox{\hyperlink{classdai_1_1TFactor_ab4ba88e0b89d62aa7709852a6cafa9e6}{\_vs}}\ |\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{g}}.\_vs;}
\DoxyCodeLine{00413\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{N}}\ =\ \mbox{\hyperlink{namespacedai_a8f9fdd7b607434fcda10d5be59f512d1}{BigInt\_size\_t}}(\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{result}}.\_vs.nrStates()\ );}
\DoxyCodeLine{00414\ }
\DoxyCodeLine{00415\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdai_1_1IndexFor}{IndexFor}}\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{i\_f}}(\ \mbox{\hyperlink{classdai_1_1TFactor_ab4ba88e0b89d62aa7709852a6cafa9e6}{\_vs}},\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{result}}.vars()\ );}
\DoxyCodeLine{00416\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdai_1_1IndexFor}{IndexFor}}\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{i\_g}}(\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{g}}.\_vs,\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{result}}.vars()\ );}
\DoxyCodeLine{00417\ }
\DoxyCodeLine{00418\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{result}}.\_p.p().clear();}
\DoxyCodeLine{00419\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{result}}.\_p.p().reserve(\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{N}}\ );}
\DoxyCodeLine{00420\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\ \textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{N}};\ i++,\ ++\mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{i\_f}},\ ++\mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{i\_g}}\ )}
\DoxyCodeLine{00421\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{result}}.\_p.p().push\_back(\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{op}}(\ \mbox{\hyperlink{classdai_1_1TFactor_a34ea1a358f9248fdcd1d0b68b1313294}{\_p}}[\mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{i\_f}}],\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{g}}[\mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{i\_g}}]\ )\ );}
\DoxyCodeLine{00422\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00423\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{result}};}
\DoxyCodeLine{00424\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00425\ }
\DoxyCodeLine{00427\ }
\DoxyCodeLine{00431\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdai_1_1TFactor}{TFactor<T>}}\ \mbox{\hyperlink{classdai_1_1TFactor_ae6c4b5f251d7e966f3a4d46ec665a0fd}{operator+\ }}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classdai_1_1TFactor}{TFactor<T>}}\&\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{g}})\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00432\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classdai_1_1TFactor_a40421e4ca261192d8f71c2db6e9da6c1}{binaryTr}}(\mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{g}},std::plus<T>());}
\DoxyCodeLine{00433\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00434\ }
\DoxyCodeLine{00436\ }
\DoxyCodeLine{00440\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdai_1_1TFactor}{TFactor<T>}}\ \mbox{\hyperlink{classdai_1_1TFactor_a6b4720129a8e9a762b1fa34e5e863b46}{operator-\/\ }}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classdai_1_1TFactor}{TFactor<T>}}\&\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{g}})\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00441\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classdai_1_1TFactor_a40421e4ca261192d8f71c2db6e9da6c1}{binaryTr}}(\mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{g}},std::minus<T>());}
\DoxyCodeLine{00442\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00443\ }
\DoxyCodeLine{00445\ }
\DoxyCodeLine{00449\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdai_1_1TFactor}{TFactor<T>}}\ \mbox{\hyperlink{classdai_1_1TFactor_afa9e4dd05b4f94531fbbf3719c97f848}{operator*\ }}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classdai_1_1TFactor}{TFactor<T>}}\&\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{g}})\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00450\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classdai_1_1TFactor_a40421e4ca261192d8f71c2db6e9da6c1}{binaryTr}}(\mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{g}},std::multiplies<T>());}
\DoxyCodeLine{00451\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00452\ }
\DoxyCodeLine{00454\ }
\DoxyCodeLine{00458\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdai_1_1TFactor}{TFactor<T>}}\ \mbox{\hyperlink{classdai_1_1TFactor_ad49392c3b36d00b55cf6ffb143bb4f71}{operator/\ }}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classdai_1_1TFactor}{TFactor<T>}}\&\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{g}})\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00459\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classdai_1_1TFactor_a40421e4ca261192d8f71c2db6e9da6c1}{binaryTr}}(\mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{g}},\mbox{\hyperlink{structdai_1_1fo__divides0}{fo\_divides0<T>}}());}
\DoxyCodeLine{00460\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00462\ }
\DoxyCodeLine{00464\ }
\DoxyCodeLine{00465\ }
\DoxyCodeLine{00477\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdai_1_1TFactor}{TFactor<T>}}\ \mbox{\hyperlink{classdai_1_1TFactor_ae9a1373a51646795b1b6b39fd6746e79}{slice}}(\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classdai_1_1VarSet}{VarSet}}\&\ \mbox{\hyperlink{classdai_1_1TFactor_a52c048326197e4d8512479b71a0c1e8f}{vars}},\ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{varsState}}\ )\ \textcolor{keyword}{const};\ }
\DoxyCodeLine{00478\ }
\DoxyCodeLine{00480\ }
\DoxyCodeLine{00485\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdai_1_1TFactor}{TFactor<T>}}\ \mbox{\hyperlink{classdai_1_1TFactor_a1675f9f07d0fbcf26e81059e3f739e97}{embed}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classdai_1_1VarSet}{VarSet}}\ \&\ \mbox{\hyperlink{classdai_1_1TFactor_a52c048326197e4d8512479b71a0c1e8f}{vars}})\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00486\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{exceptions_8h_af50adc4fad1e07093579e746302bc884}{DAI\_ASSERT}}(\ \mbox{\hyperlink{classdai_1_1TFactor_a52c048326197e4d8512479b71a0c1e8f}{vars}}\ >>\ \mbox{\hyperlink{classdai_1_1TFactor_ab4ba88e0b89d62aa7709852a6cafa9e6}{\_vs}}\ );}
\DoxyCodeLine{00487\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\ \mbox{\hyperlink{classdai_1_1TFactor_ab4ba88e0b89d62aa7709852a6cafa9e6}{\_vs}}\ ==\ \mbox{\hyperlink{classdai_1_1TFactor_a52c048326197e4d8512479b71a0c1e8f}{vars}}\ )}
\DoxyCodeLine{00488\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{this};}
\DoxyCodeLine{00489\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00490\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ (*\textcolor{keyword}{this})\ *\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{TFactor<T>}}(\mbox{\hyperlink{classdai_1_1TFactor_a52c048326197e4d8512479b71a0c1e8f}{vars}}\ /\ \mbox{\hyperlink{classdai_1_1TFactor_ab4ba88e0b89d62aa7709852a6cafa9e6}{\_vs}},\ (T)1);}
\DoxyCodeLine{00491\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00492\ }
\DoxyCodeLine{00494\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdai_1_1TFactor}{TFactor<T>}}\ \mbox{\hyperlink{classdai_1_1TFactor_ab18d34852ba2136a6329dccbb1a5815b}{marginal}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classdai_1_1VarSet}{VarSet}}\ \&\mbox{\hyperlink{classdai_1_1TFactor_a52c048326197e4d8512479b71a0c1e8f}{vars}},\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{normed}}=\textcolor{keyword}{true})\ \textcolor{keyword}{const};}
\DoxyCodeLine{00495\ }
\DoxyCodeLine{00497\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdai_1_1TFactor}{TFactor<T>}}\ \mbox{\hyperlink{classdai_1_1TFactor_af0abd6272501181930cde97570808be7}{maxMarginal}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classdai_1_1VarSet}{VarSet}}\ \&\mbox{\hyperlink{classdai_1_1TFactor_a52c048326197e4d8512479b71a0c1e8f}{vars}},\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{normed}}=\textcolor{keyword}{true})\ \textcolor{keyword}{const};}
\DoxyCodeLine{00499\ \};}
\DoxyCodeLine{00500\ }
\DoxyCodeLine{00501\ }
\DoxyCodeLine{00502\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ T>\ \mbox{\hyperlink{classdai_1_1TFactor}{TFactor<T>}}\ \mbox{\hyperlink{classdai_1_1TFactor_ae9a1373a51646795b1b6b39fd6746e79}{TFactor<T>::slice}}(\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classdai_1_1VarSet}{VarSet}}\&\ vars,\ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{varsState}}\ )\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00503\ \ \ \ \ \mbox{\hyperlink{exceptions_8h_af50adc4fad1e07093579e746302bc884}{DAI\_ASSERT}}(\ vars\ <<\ \_vs\ );}
\DoxyCodeLine{00504\ \ \ \ \ \mbox{\hyperlink{classdai_1_1VarSet}{VarSet}}\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{varsrem}}\ =\ \_vs\ /\ vars;}
\DoxyCodeLine{00505\ \ \ \ \ \mbox{\hyperlink{classdai_1_1TFactor}{TFactor<T>}}\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{result}}(\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{varsrem}},\ T(0)\ );}
\DoxyCodeLine{00506\ }
\DoxyCodeLine{00507\ \ \ \ \ \textcolor{comment}{//\ OPTIMIZE\ ME}}
\DoxyCodeLine{00508\ \ \ \ \ \mbox{\hyperlink{classdai_1_1IndexFor}{IndexFor}}\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{i\_vars}}\ (vars,\ \_vs);}
\DoxyCodeLine{00509\ \ \ \ \ \mbox{\hyperlink{classdai_1_1IndexFor}{IndexFor}}\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{i\_varsrem}}\ (\mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{varsrem}},\ \_vs);}
\DoxyCodeLine{00510\ \ \ \ \ \textcolor{keywordflow}{for}(\ \textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ nrStates();\ i++,\ ++\mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{i\_vars}},\ ++\mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{i\_varsrem}}\ )}
\DoxyCodeLine{00511\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\ (\textcolor{keywordtype}{size\_t})\mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{i\_vars}}\ ==\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{varsState}}\ )}
\DoxyCodeLine{00512\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{result}}.set(\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{i\_varsrem}},\ \_p[i]\ );}
\DoxyCodeLine{00513\ }
\DoxyCodeLine{00514\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{result}};}
\DoxyCodeLine{00515\ \}}
\DoxyCodeLine{00516\ }
\DoxyCodeLine{00517\ }
\DoxyCodeLine{00518\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ T>\ \mbox{\hyperlink{classdai_1_1TFactor}{TFactor<T>}}\ \mbox{\hyperlink{classdai_1_1TFactor_ab18d34852ba2136a6329dccbb1a5815b}{TFactor<T>::marginal}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classdai_1_1VarSet}{VarSet}}\ \&vars,\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{normed}})\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00519\ \ \ \ \ \mbox{\hyperlink{classdai_1_1VarSet}{VarSet}}\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{res\_vars}}\ =\ vars\ \&\ \_vs;}
\DoxyCodeLine{00520\ }
\DoxyCodeLine{00521\ \ \ \ \ \mbox{\hyperlink{classdai_1_1TFactor}{TFactor<T>}}\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{res}}(\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{res\_vars}},\ 0.0\ );}
\DoxyCodeLine{00522\ }
\DoxyCodeLine{00523\ \ \ \ \ \mbox{\hyperlink{classdai_1_1IndexFor}{IndexFor}}\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{i\_res}}(\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{res\_vars}},\ \_vs\ );}
\DoxyCodeLine{00524\ \ \ \ \ \textcolor{keywordflow}{for}(\ \textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ \_p.size();\ i++,\ ++\mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{i\_res}}\ )}
\DoxyCodeLine{00525\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{res}}.set(\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{i\_res}},\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{res}}[\mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{i\_res}}]\ +\ \_p[i]\ );}
\DoxyCodeLine{00526\ }
\DoxyCodeLine{00527\ \ \ \ \ \textcolor{keywordflow}{if}(\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{normed}}\ )}
\DoxyCodeLine{00528\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{res}}.normalize(\ NORMPROB\ );}
\DoxyCodeLine{00529\ }
\DoxyCodeLine{00530\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{res}};}
\DoxyCodeLine{00531\ \}}
\DoxyCodeLine{00532\ }
\DoxyCodeLine{00533\ }
\DoxyCodeLine{00534\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ T>\ \mbox{\hyperlink{classdai_1_1TFactor}{TFactor<T>}}\ \mbox{\hyperlink{classdai_1_1TFactor_af0abd6272501181930cde97570808be7}{TFactor<T>::maxMarginal}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classdai_1_1VarSet}{VarSet}}\ \&vars,\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{normed}})\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00535\ \ \ \ \ \mbox{\hyperlink{classdai_1_1VarSet}{VarSet}}\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{res\_vars}}\ =\ vars\ \&\ \_vs;}
\DoxyCodeLine{00536\ }
\DoxyCodeLine{00537\ \ \ \ \ \mbox{\hyperlink{classdai_1_1TFactor}{TFactor<T>}}\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{res}}(\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{res\_vars}},\ 0.0\ );}
\DoxyCodeLine{00538\ }
\DoxyCodeLine{00539\ \ \ \ \ \mbox{\hyperlink{classdai_1_1IndexFor}{IndexFor}}\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{i\_res}}(\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{res\_vars}},\ \_vs\ );}
\DoxyCodeLine{00540\ \ \ \ \ \textcolor{keywordflow}{for}(\ \textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ \_p.size();\ i++,\ ++\mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{i\_res}}\ )}
\DoxyCodeLine{00541\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\ \_p[i]\ >\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{res}}.\_p[\mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{i\_res}}]\ )}
\DoxyCodeLine{00542\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{res}}.set(\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{i\_res}},\ \_p[i]\ );}
\DoxyCodeLine{00543\ }
\DoxyCodeLine{00544\ \ \ \ \ \textcolor{keywordflow}{if}(\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{normed}}\ )}
\DoxyCodeLine{00545\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{res}}.normalize(\ NORMPROB\ );}
\DoxyCodeLine{00546\ }
\DoxyCodeLine{00547\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{res}};}
\DoxyCodeLine{00548\ \}}
\DoxyCodeLine{00549\ }
\DoxyCodeLine{00550\ }
\DoxyCodeLine{00551\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ T>\ T\ \mbox{\hyperlink{classdai_1_1TFactor_a79c10008a081bf56e79fab4fb9d564f7}{TFactor<T>::strength}}(\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classdai_1_1Var}{Var}}\ \&i,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classdai_1_1Var}{Var}}\ \&\mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{j}}\ )\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00552\ \ \ \ \ \mbox{\hyperlink{exceptions_8h_ab0d3e811b3335ac42245ec03864ede45}{DAI\_DEBASSERT}}(\ \_vs.contains(\ i\ )\ );}
\DoxyCodeLine{00553\ \ \ \ \ \mbox{\hyperlink{exceptions_8h_ab0d3e811b3335ac42245ec03864ede45}{DAI\_DEBASSERT}}(\ \_vs.contains(\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{j}}\ )\ );}
\DoxyCodeLine{00554\ \ \ \ \ \mbox{\hyperlink{exceptions_8h_ab0d3e811b3335ac42245ec03864ede45}{DAI\_DEBASSERT}}(\ i\ !=\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{j}}\ );}
\DoxyCodeLine{00555\ \ \ \ \ \mbox{\hyperlink{classdai_1_1VarSet}{VarSet}}\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{ij}}(i,\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{j}});}
\DoxyCodeLine{00556\ }
\DoxyCodeLine{00557\ \ \ \ \ T\ max\ =\ 0.0;}
\DoxyCodeLine{00558\ \ \ \ \ \textcolor{keywordflow}{for}(\ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{alpha1}}\ =\ 0;\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{alpha1}}\ <\ i.\mbox{\hyperlink{classdai_1_1Var_a155ae28d86fb7fbc3f050428e2379f40}{states}}();\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{alpha1}}++\ )}
\DoxyCodeLine{00559\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{alpha2}}\ =\ 0;\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{alpha2}}\ <\ i.\mbox{\hyperlink{classdai_1_1Var_a155ae28d86fb7fbc3f050428e2379f40}{states}}();\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{alpha2}}++\ )}
\DoxyCodeLine{00560\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{alpha2}}\ !=\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{alpha1}}\ )}
\DoxyCodeLine{00561\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{beta1}}\ =\ 0;\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{beta1}}\ <\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{j}}.states();\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{beta1}}++\ )}
\DoxyCodeLine{00562\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{beta2}}\ =\ 0;\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{beta2}}\ <\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{j}}.states();\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{beta2}}++\ )}
\DoxyCodeLine{00563\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{beta2}}\ !=\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{beta1}}\ )\ \{}
\DoxyCodeLine{00564\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{as}}\ =\ 1,\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{bs}}\ =\ 1;}
\DoxyCodeLine{00565\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\ i\ <\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{j}}\ )}
\DoxyCodeLine{00566\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{bs}}\ =\ i.\mbox{\hyperlink{classdai_1_1Var_a155ae28d86fb7fbc3f050428e2379f40}{states}}();}
\DoxyCodeLine{00567\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00568\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{as}}\ =\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{j}}.states();}
\DoxyCodeLine{00569\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ T\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{f1}}\ =\ slice(\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{ij}},\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{alpha1}}\ *\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{as}}\ +\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{beta1}}\ *\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{bs}}\ ).p().divide(\ slice(\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{ij}},\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{alpha2}}\ *\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{as}}\ +\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{beta1}}\ *\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{bs}}\ ).p()\ ).max();}
\DoxyCodeLine{00570\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ T\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{f2}}\ =\ slice(\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{ij}},\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{alpha2}}\ *\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{as}}\ +\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{beta2}}\ *\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{bs}}\ ).p().divide(\ slice(\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{ij}},\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{alpha1}}\ *\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{as}}\ +\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{beta2}}\ *\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{bs}}\ ).p()\ ).max();}
\DoxyCodeLine{00571\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ T\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{f}}\ =\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{f1}}\ *\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{f2}};}
\DoxyCodeLine{00572\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{f}}\ >\ max\ )}
\DoxyCodeLine{00573\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ max\ =\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{f}};}
\DoxyCodeLine{00574\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00575\ }
\DoxyCodeLine{00576\ \ \ \ \ \textcolor{keywordflow}{return}\ std::tanh(\ 0.25\ *\ std::log(\ max\ )\ );}
\DoxyCodeLine{00577\ \}}
\DoxyCodeLine{00578\ }
\DoxyCodeLine{00579\ }
\DoxyCodeLine{00581\ }
\DoxyCodeLine{00583\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ T>\ std::ostream\&\ \mbox{\hyperlink{namespacedai_a7ad7d2f9f5b1db63093dd0218aa6432b}{operator<<\ }}(std::ostream\&\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{os}},\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classdai_1_1TFactor}{TFactor<T>}}\&\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{f}})\ \{}
\DoxyCodeLine{00584\ \ \ \ \ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{os}}\ <<\ \textcolor{stringliteral}{"{}("{}}\ <<\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{f}}.vars()\ <<\ \textcolor{stringliteral}{"{},\ ("{}};}
\DoxyCodeLine{00585\ \ \ \ \ \textcolor{keywordflow}{for}(\ \textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{f}}.nrStates();\ i++\ )}
\DoxyCodeLine{00586\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{os}}\ <<\ (i\ ==\ 0\ ?\ \textcolor{stringliteral}{"{}"{}}\ :\ \textcolor{stringliteral}{"{},\ "{}})\ <<\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{f}}[i];}
\DoxyCodeLine{00587\ \ \ \ \ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{os}}\ <<\ \textcolor{stringliteral}{"{}))"{}};}
\DoxyCodeLine{00588\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{os}};}
\DoxyCodeLine{00589\ \}}
\DoxyCodeLine{00590\ }
\DoxyCodeLine{00591\ }
\DoxyCodeLine{00593\ }
\DoxyCodeLine{00596\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ T>\ T\ \mbox{\hyperlink{classdai_1_1TFactor_aefdaa35a881dd00aff2894986f5967c2}{dist}}(\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classdai_1_1TFactor}{TFactor<T>}}\ \&\mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{f}},\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classdai_1_1TFactor}{TFactor<T>}}\ \&\mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{g}},\ \mbox{\hyperlink{namespacedai_aa2735a823696443089d2de23e8ee6ecb}{ProbDistType}}\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{dt}}\ )\ \{}
\DoxyCodeLine{00597\ \ \ \ \ \textcolor{keywordflow}{if}(\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{f}}.vars().empty()\ ||\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{g}}.vars().empty()\ )}
\DoxyCodeLine{00598\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{00599\ \ \ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00600\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{exceptions_8h_ab0d3e811b3335ac42245ec03864ede45}{DAI\_DEBASSERT}}(\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{f}}.vars()\ ==\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{g}}.vars()\ );}
\DoxyCodeLine{00601\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{namespacedai_aee9a0cc9279a7add0849f964e3bdfbed}{dist}}(\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{f}}.p(),\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{g}}.p(),\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{dt}}\ );}
\DoxyCodeLine{00602\ \ \ \ \ \}}
\DoxyCodeLine{00603\ \}}
\DoxyCodeLine{00604\ }
\DoxyCodeLine{00605\ }
\DoxyCodeLine{00607\ }
\DoxyCodeLine{00610\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ T>\ \mbox{\hyperlink{classdai_1_1TFactor}{TFactor<T>}}\ \mbox{\hyperlink{classdai_1_1TFactor_a2cccf0cd38b68a3b22b167b2af90e518}{max}}(\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classdai_1_1TFactor}{TFactor<T>}}\ \&\mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{f}},\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classdai_1_1TFactor}{TFactor<T>}}\ \&\mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{g}}\ )\ \{}
\DoxyCodeLine{00611\ \ \ \ \ \mbox{\hyperlink{exceptions_8h_af50adc4fad1e07093579e746302bc884}{DAI\_ASSERT}}(\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{f}}.vars()\ ==\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{g}}.vars()\ );}
\DoxyCodeLine{00612\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{TFactor<T>}}(\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{f}}.vars(),\ max(\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{f}}.p(),\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{g}}.p()\ )\ );}
\DoxyCodeLine{00613\ \}}
\DoxyCodeLine{00614\ }
\DoxyCodeLine{00615\ }
\DoxyCodeLine{00617\ }
\DoxyCodeLine{00620\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ T>\ \mbox{\hyperlink{classdai_1_1TFactor}{TFactor<T>}}\ \mbox{\hyperlink{classdai_1_1TFactor_a30ea8a783f28550835226f139fa87e97}{min}}(\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classdai_1_1TFactor}{TFactor<T>}}\ \&\mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{f}},\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classdai_1_1TFactor}{TFactor<T>}}\ \&\mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{g}}\ )\ \{}
\DoxyCodeLine{00621\ \ \ \ \ \mbox{\hyperlink{exceptions_8h_af50adc4fad1e07093579e746302bc884}{DAI\_ASSERT}}(\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{f}}.vars()\ ==\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{g}}.vars()\ );}
\DoxyCodeLine{00622\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{TFactor<T>}}(\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{f}}.vars(),\ min(\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{f}}.p(),\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{g}}.p()\ )\ );}
\DoxyCodeLine{00623\ \}}
\DoxyCodeLine{00624\ }
\DoxyCodeLine{00625\ }
\DoxyCodeLine{00627\ }
\DoxyCodeLine{00630\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ T>\ T\ \mbox{\hyperlink{classdai_1_1TFactor_a2f0ced4bc2927eea87bf14438aa63f8e}{MutualInfo}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classdai_1_1TFactor}{TFactor<T>}}\ \&\mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{f}})\ \{}
\DoxyCodeLine{00631\ \ \ \ \ \mbox{\hyperlink{exceptions_8h_af50adc4fad1e07093579e746302bc884}{DAI\_ASSERT}}(\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{f}}.vars().size()\ ==\ 2\ );}
\DoxyCodeLine{00632\ \ \ \ \ \mbox{\hyperlink{classdai_1_1SmallSet_aa922e181341753250416ea1649de390a}{VarSet::const\_iterator}}\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{it}}\ =\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{f}}.vars().begin();}
\DoxyCodeLine{00633\ \ \ \ \ \mbox{\hyperlink{classdai_1_1Var}{Var}}\ i\ =\ *\mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{it}};\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{it}}++;\ \mbox{\hyperlink{classdai_1_1Var}{Var}}\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{j}}\ =\ *\mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{it}};}
\DoxyCodeLine{00634\ \ \ \ \ \mbox{\hyperlink{classdai_1_1TFactor}{TFactor<T>}}\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{projection}}\ =\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{f}}.\mbox{\hyperlink{classdai_1_1TFactor_ab18d34852ba2136a6329dccbb1a5815b}{marginal}}(i)\ *\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{f}}.marginal(\mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{j}});}
\DoxyCodeLine{00635\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{namespacedai_aee9a0cc9279a7add0849f964e3bdfbed}{dist}}(\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{f}}.normalized(),\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{projection}},\ DISTKL\ );}
\DoxyCodeLine{00636\ \}}
\DoxyCodeLine{00637\ }
\DoxyCodeLine{00638\ }
\DoxyCodeLine{00640\ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{classdai_1_1TFactor}{TFactor<Real>}}\ \mbox{\hyperlink{namespacedai_a7515abf9952cd312e95a34ada0670e85}{Factor}};}
\DoxyCodeLine{00641\ }
\DoxyCodeLine{00642\ }
\DoxyCodeLine{00644\ }
\DoxyCodeLine{00647\ \mbox{\hyperlink{classdai_1_1TFactor}{Factor}}\ \mbox{\hyperlink{namespacedai_a7dd9cb2405e798802d8cbb9b879fdf90}{createFactorIsing}}(\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classdai_1_1Var}{Var}}\ \&\mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{x}},\ \mbox{\hyperlink{namespacedai_ae7d0472fdc89a8635825d01940e91cbf}{Real}}\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{h}}\ );}
\DoxyCodeLine{00648\ }
\DoxyCodeLine{00649\ }
\DoxyCodeLine{00651\ }
\DoxyCodeLine{00655\ \mbox{\hyperlink{classdai_1_1TFactor}{Factor}}\ \mbox{\hyperlink{namespacedai_a7dd9cb2405e798802d8cbb9b879fdf90}{createFactorIsing}}(\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classdai_1_1Var}{Var}}\ \&\mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{x1}},\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classdai_1_1Var}{Var}}\ \&\mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{x2}},\ \mbox{\hyperlink{namespacedai_ae7d0472fdc89a8635825d01940e91cbf}{Real}}\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{J}}\ );}
\DoxyCodeLine{00656\ }
\DoxyCodeLine{00657\ }
\DoxyCodeLine{00659\ }
\DoxyCodeLine{00664\ \mbox{\hyperlink{classdai_1_1TFactor}{Factor}}\ \mbox{\hyperlink{namespacedai_a6715831e60e66582bce1c69518a40dd3}{createFactorExpGauss}}(\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classdai_1_1VarSet}{VarSet}}\ \&\mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{vs}},\ \mbox{\hyperlink{namespacedai_ae7d0472fdc89a8635825d01940e91cbf}{Real}}\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{beta}}\ );}
\DoxyCodeLine{00665\ }
\DoxyCodeLine{00666\ }
\DoxyCodeLine{00668\ }
\DoxyCodeLine{00672\ \mbox{\hyperlink{classdai_1_1TFactor}{Factor}}\ \mbox{\hyperlink{namespacedai_aab6d25e30baf39ea06c57b5f71c61a4e}{createFactorPotts}}(\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classdai_1_1Var}{Var}}\ \&\mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{x1}},\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classdai_1_1Var}{Var}}\ \&\mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{x2}},\ \mbox{\hyperlink{namespacedai_ae7d0472fdc89a8635825d01940e91cbf}{Real}}\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{J}}\ );}
\DoxyCodeLine{00673\ }
\DoxyCodeLine{00674\ }
\DoxyCodeLine{00676\ }
\DoxyCodeLine{00679\ \mbox{\hyperlink{classdai_1_1TFactor}{Factor}}\ \mbox{\hyperlink{namespacedai_adf624997c47362bc5db95242b76a66a4}{createFactorDelta}}(\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classdai_1_1Var}{Var}}\ \&\mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{v}},\ \textcolor{keywordtype}{size\_t}\ state\ );}
\DoxyCodeLine{00680\ }
\DoxyCodeLine{00681\ }
\DoxyCodeLine{00683\ }
\DoxyCodeLine{00686\ \mbox{\hyperlink{classdai_1_1TFactor}{Factor}}\ \mbox{\hyperlink{namespacedai_adf624997c47362bc5db95242b76a66a4}{createFactorDelta}}(\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classdai_1_1VarSet}{VarSet}}\&\ \mbox{\hyperlink{namespacedai_a94b4dd96324af3c0511584a0925f9c15}{vs}},\ \textcolor{keywordtype}{size\_t}\ state\ );}
\DoxyCodeLine{00687\ }
\DoxyCodeLine{00688\ }
\DoxyCodeLine{00689\ \}\ \textcolor{comment}{//\ end\ of\ namespace\ dai}}
\DoxyCodeLine{00690\ }
\DoxyCodeLine{00691\ }
\DoxyCodeLine{00692\ \textcolor{preprocessor}{\#endif}}

\end{DoxyCode}
